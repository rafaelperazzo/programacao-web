function y=f(x)//Definição da função do livro Cálculo Numérico com Aplicações 2 edição, Leônidas Barroso.
    y=(1/(2*%pi)^(1/2))*%e^-((x^2)/2)
endfunction
a=0 //Definição dos parâmetros do problema
b=1.8
n=6
function integra=trapezio(a,b,n)//Definição da função para calcular a integral pelo método do trapézio
  h=(b-a)/n;//Definição do  tamanho do passo através dos extremos e do número de aplicações
  Somatorio = f(a) + f(b);//Somatorio para a obtenção do resultado final; Com os primeiros valores inseridos 
  for k=1:n-1 //Criação de um laço para varrer todo o intervalo analisado; Onde o primeiro e o último f são excluídos
    Somatorio=Somatorio + 2*f(a+k*h);//Criação do somatório com multiplicação pelo índice 2 como estabelecido no método
  end;
  integra= (h/2)*Somatorio;//Aplicação do ultimo passo da regra, a fim do calculo da integral em questão
endfunction
function integral=simpson(a,b,n) //Definição da Função Simpson 1/3 para o calculo da integral, 
    //Tal função contará com a e b, os extremos da integral em questão e n correspondente ao número de aplicação da regra que você deseja analisar
    h=(b-a)/n //Definição do  tamanho do passo através dos extremos e do número de aplicações
    somatorio=0; //Somatorio para a obtenção do resultado final
    for i=1:n-1 //Criação de um laço para varrer todo o intervalo analisado
        x=a+i*h //Definição do x, valor a ser implementado na função para a obtenção de um resultado parcial
        if modulo(i,2)==0 //Definição de uma condição para verificar por qual multiplicador 2 ou 4(fórmula) iremos utilizar no item analisado, adotaremos multiplicador 2 quando o número em  questão for par e 4 quando for impar
            somatorio=somatorio+2*f(x)
        else 
            somatorio=somatorio+4*f(x)
        end 
    end
    integral=(h/3)*(f(a)+f(b)+somatorio)//Aplicação do ultimo passo da regra, a fim do calculo da integral em questão
    h=(b-a)/n//Definição do  tamanho do passo através dos extremos e do número de aplicações
    z=a:h:b//Criação do passo que o gráfico seguirá
    title("Gráfico")
    title("OBS: Caso deseje calcular outro intevalo, por favor feche esta aba.")//Instruções de uso do gráfico
    plot(z,f,x)//Comando para plotar o gráfico em questão
endfunction
disp("O valor calculado através da regra do Trapezio para ")
disp(n)
disp("segmentos definidos entre ")
disp(a) 
disp(" e ")
disp(b)
disp(" Resultou em: ")
disp(0.5+trapezio(a,b,n))//Resultado obtido pelo método do trapézio
disp("--------------------------------------------------------------")
disp("O valor calculado através da primeira regra de Simpson para ")
disp(n)
disp("segmentos definidos entre ")
disp(a) 
disp(" e ")
disp(b)
disp(" Resultou em: ")
disp (0.5+simpson(a,b,n))//Resultado obtido pelo método de Simpson 1/3
y=input("Digite (1) UM caso deseje calcular a integral para outro intervalo ou outro número de segmentos ou (0) ZERO para encerrar)")
if abs(y)==1 then //Criação de uma condição para um laço de cálculo
    while abs(y)==1 //Criação de um laço para efetuar novos cálculos a critério de usuário
        a=input("Digite o valor do limite inferior da integral (a)")//Insersão de novos dados a critério do usuário
        b=input("Digite o valor do limite superior da integral (b)")
        n=input("Digite a quantidade de segmentos que se deseja calcular (n)")
        disp("O valor calculado através da regra do Trapezio para ")
        disp(n)
        disp("segmentos definidos entre ")
        disp(a) 
        disp(" e ")
        disp(b)
        disp(" Resultou em: ")
        disp(0.5+trapezio(a,b,n))//Resultado obtido pelo método do trapézio
        disp("--------------------------------------------------------------")
        disp("O valor calculado através da primeira regra de Simpson para ")
        disp(n)
        disp("segmentos definidos entre ")
        disp(a) 
        disp(" e ")
        disp(b)
        disp(" Resultou em: ")
        disp (0.5+simpson(a,b,n))//Resultado obtido pelo método de Simpson 1/3
        y=input("Digite (0)ZERO caso deseje encerrar o programa ou (1)UM para realizar outro calculo")
        if abs(y)==0 then //Condição para encerramento do programa
            disp("Programa encerrado")
            break
        end
    end
elseif abs(y)==0 then // Comando de encerramento
    disp("Programa encerrado")
    break
else
    disp("Valor incorreto")
    break
end
